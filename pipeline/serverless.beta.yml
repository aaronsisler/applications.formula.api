service: formula-api

provider:
  name: aws
  runtime: nodejs12.x
  stage: beta
  region: us-east-1
  iam:
    role: arn:aws:iam::654918520080:role/APIG-LAMBDA-DDB
  apiGateway:
    usagePlan:
      quota:
        limit: 500
        offset: 0
        period: MONTH
      throttle:
        burstLimit: 20
        rateLimit: 10

functions:
  health:
    handler: dist/handlers/health-handler/index.handler
    description: Gateway health check. Responds with current time and a short message.
    events:
      - http:
          path: /health
          method: get
  user-post:
    handler: dist/handlers/user-post-handler/index.handler
    description: Retrieve user with OAuth token. Create user with given user information.
    events:
      - http:
          path: /user
          method: post

plugins:
  - serverless-domain-manager

custom:
  customDomain:
    domainName: formula.otterandcow.com
    basePath: "beta"
    stage: beta
    createRoute53Record: true
